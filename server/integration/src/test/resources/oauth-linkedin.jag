<%
var param = request.getParameter('param');
var oauth = require("oauth");
var twitter = session.get('cnt');
var accessToken = session.get('atoken');
var authCode = request.getParameter('atoken');

var log = new Log();

if(param==5){
	twitter  = null;
	log.info("twitter Null");
}
if(param==1){

var linkedProvider = {
    "oauth_version" : "1",
    "authorization_url" : "https://www.linkedin.com/uas/oauth/authorize",
    "access_token_url" : "https://api.linkedin.com/uas/oauth/accessToken",
    "request_token_url" : "https://api.linkedin.com/uas/oauth/requestToken?scope=r_fullprofile",
    "api_key" : "whfnw5t66ttn",
    "api_secret" : "mphuKk8YhOVipj6n"
}


if (twitter == null ) {

	//	var twitter = new oauth.OAuthProvider(oauth.twitterAPI("d0CTc4Zg9pufCnMkteDc7w","z4FMZhP87U5QEwycggDe5JN6TDDh7xEyhnAcEpdWk"));
		var twitter = new oauth.OAuthProvider(linkedProvider);
		session.put("cnt", twitter);
		var authUrl = twitter.getAuthorizationUrl();

		print(authUrl);
	}
	} else if (twitter != null && authCode != null && accessToken == null) {
	log.info("twt not null");
		var accessToken = twitter.getAccessToken(authCode);
		session.put('atoken', accessToken);
		log.info(accessToken);
		var requestParams = {
		};
		var resp = twitter.sendOAuthRequest(accessToken, "GET", "http://api.linkedin.com/v1/people/~?format=json", requestParams);
		log.info(resp);
		print(resp.getBody());	
	
	} else if (twitter != null && accessToken != null) {
			//if (loadback != null) {
			var requestParams = {
			};
			var resp = twitter.sendOAuthRequest(accessToken, "GET", "http://api.linkedin.com/v1/people/~?format=json", requestParams);
			print(resp.getBody());
		//}
	}
	
%>